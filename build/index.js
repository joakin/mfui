!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="/w/extensions/Cards/build/",e(0)}([function(t,e,n){t.exports=window.mfui={cards:n(14)}},function(t,e,n){var r=n(7);r.Template=n(8).Template,r.template=r.Template,t.exports=r},function(t,e,n){function r(t){var e=this;this.cardViews=t||[],this.$el=$(this.template.render()),$.each(this.cardViews,function(t,n){e.$el.append(n.$el)})}r.prototype.template=n(11),t.exports=r},function(t,e,n){function r(t){s.call(this),this.attributes=t}var i=n(9),s=n(5).EventEmitter;i(r,s),r.prototype.set=function(t,e,n){var r={};this.attributes[t]=e,n||(r[t]=e,this.emit("change",r))},r.prototype.get=function(t){return this.attributes[t]},t.exports=r},function(t,e,n){function r(t){this.model=t,this.model.on("change",this.render.bind(this)),this.$el=$(this._render())}n(13),r.prototype.template=n(10),r.prototype.render=function(){this.$el.replaceWith(this._render())},r.prototype._render=function(){var t=$.extend({},this.model.attributes);return t.thumbnailUrl=CSS.escape(t.thumbnailUrl),this.template.render(t)},t.exports=r},function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function i(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function a(t){return void 0===t}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!i(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,i,o,u,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var l=new Error('Uncaught, unspecified "error" event. ('+e+")");throw l.context=e,l}if(n=this._events[t],a(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),n.apply(this,o)}else if(s(n))for(o=Array.prototype.slice.call(arguments,1),c=n.slice(),i=c.length,u=0;u<i;u++)c[u].apply(this,o);return!0},n.prototype.addListener=function(t,e){var i;if(!r(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned&&(i=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[t].length>i&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function n(){this.removeListener(t,n),i||(i=!0,e.apply(this,arguments))}if(!r(e))throw TypeError("listener must be a function");var i=!1;return n.listener=e,this.on(t,n),this},n.prototype.removeListener=function(t,e){var n,i,a,o;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],a=n.length,i=-1,n===e||r(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(n)){for(o=a;o-- >0;)if(n[o]===e||n[o].listener&&n[o].listener===e){i=o;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],r(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(r(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e){},function(t,e,n){!function(t){function e(t){"}"===t.n.substr(t.n.length-1)&&(t.n=t.n.substring(0,t.n.length-1))}function n(t){return t.trim?t.trim():t.replace(/^\s*|\s*$/g,"")}function r(t,e,n){if(e.charAt(n)!=t.charAt(0))return!1;for(var r=1,i=t.length;r<i;r++)if(e.charAt(n+r)!=t.charAt(r))return!1;return!0}function i(e,n,r,o){var u=[],c=null,l=null,h=null;for(l=r[r.length-1];e.length>0;){if(h=e.shift(),l&&"<"==l.tag&&!(h.tag in _))throw new Error("Illegal content in < super tag.");if(t.tags[h.tag]<=t.tags.$||s(h,o))r.push(h),h.nodes=i(e,h.tag,r,o);else{if("/"==h.tag){if(0===r.length)throw new Error("Closing tag without opener: /"+h.n);if(c=r.pop(),h.n!=c.n&&!a(h.n,c.n,o))throw new Error("Nesting error: "+c.n+" vs. "+h.n);return c.end=h.i,u}"\n"==h.tag&&(h.last=0==e.length||"\n"==e[0].tag)}u.push(h)}if(r.length>0)throw new Error("missing closing tag: "+r.pop().n);return u}function s(t,e){for(var n=0,r=e.length;n<r;n++)if(e[n].o==t.n)return t.tag="#",!0}function a(t,e,n){for(var r=0,i=n.length;r<i;r++)if(n[r].c==t&&n[r].o==e)return!0}function o(t){var e=[];for(var n in t)e.push('"'+c(n)+'": function(c,p,t,i) {'+t[n]+"}");return"{ "+e.join(",")+" }"}function u(t){var e=[];for(var n in t.partials)e.push('"'+c(n)+'":{name:"'+c(t.partials[n].name)+'", '+u(t.partials[n])+"}");return"partials: {"+e.join(",")+"}, subs: "+o(t.subs)}function c(t){return t.replace(m,"\\\\").replace(d,'\\"').replace(b,"\\n").replace(g,"\\r").replace(x,"\\u2028").replace(y,"\\u2029")}function l(t){return~t.indexOf(".")?"d":"f"}function h(t,e){var n="<"+(e.prefix||""),r=n+t.n+w++;return e.partials[r]={name:t.n,partials:{}},e.code+='t.b(t.rp("'+c(r)+'",c,p,"'+(t.indent||"")+'"));',r}function f(t,e){e.code+="t.b(t.t(t."+l(t.n)+'("'+c(t.n)+'",c,p,0)));'}function p(t){return"t.b("+t+");"}var v=/\S/,d=/\"/g,b=/\n/g,g=/\r/g,m=/\\/g,x=/\u2028/,y=/\u2029/;t.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},t.scan=function(i,s){function a(){m.length>0&&(x.push({tag:"_t",text:new String(m)}),m="")}function o(){for(var e=!0,n=w;n<x.length;n++)if(e=t.tags[x[n].tag]<t.tags._v||"_t"==x[n].tag&&null===x[n].text.match(v),!e)return!1;return e}function u(t,e){if(a(),t&&o())for(var n,r=w;r<x.length;r++)x[r].text&&((n=x[r+1])&&">"==n.tag&&(n.indent=x[r].text.toString()),x.splice(r,1));else e||x.push({tag:"\n"});y=!1,w=x.length}function c(t,e){var r="="+L,i=t.indexOf(r,e),s=n(t.substring(t.indexOf("=",e)+1,i)).split(" ");return k=s[0],L=s[s.length-1],i+r.length-1}var l=i.length,h=0,f=1,p=2,d=h,b=null,g=null,m="",x=[],y=!1,_=0,w=0,k="{{",L="}}";for(s&&(s=s.split(" "),k=s[0],L=s[1]),_=0;_<l;_++)d==h?r(k,i,_)?(--_,a(),d=f):"\n"==i.charAt(_)?u(y):m+=i.charAt(_):d==f?(_+=k.length-1,g=t.tags[i.charAt(_+1)],b=g?i.charAt(_+1):"_v","="==b?(_=c(i,_),d=h):(g&&_++,d=p),y=_):r(L,i,_)?(x.push({tag:b,n:n(m),otag:k,ctag:L,i:"/"==b?y-k.length:_+L.length}),m="",_+=L.length-1,d=h,"{"==b&&("}}"==L?_++:e(x[x.length-1]))):m+=i.charAt(_);return u(y,!0),x};var _={_t:!0,"\n":!0,$:!0,"/":!0};t.stringify=function(e,n,r){return"{code: function (c,p,i) { "+t.wrapMain(e.code)+" },"+u(e)+"}"};var w=0;t.generate=function(e,n,r){w=0;var i={code:"",subs:{},partials:{}};return t.walk(e,i),r.asString?this.stringify(i,n,r):this.makeTemplate(i,n,r)},t.wrapMain=function(t){return'var t=this;t.b(i=i||"");'+t+"return t.fl();"},t.template=t.Template,t.makeTemplate=function(t,e,n){var r=this.makePartials(t);return r.code=new Function("c","p","i",this.wrapMain(t.code)),new this.template(r,e,this,n)},t.makePartials=function(t){var e,n={subs:{},partials:t.partials,name:t.name};for(e in n.partials)n.partials[e]=this.makePartials(n.partials[e]);for(e in t.subs)n.subs[e]=new Function("c","p","t","i",t.subs[e]);return n},t.codegen={"#":function(e,n){n.code+="if(t.s(t."+l(e.n)+'("'+c(e.n)+'",c,p,1),c,p,0,'+e.i+","+e.end+',"'+e.otag+" "+e.ctag+'")){t.rs(c,p,function(c,p,t){',t.walk(e.nodes,n),n.code+="});c.pop();}"},"^":function(e,n){n.code+="if(!t.s(t."+l(e.n)+'("'+c(e.n)+'",c,p,1),c,p,1,0,0,"")){',t.walk(e.nodes,n),n.code+="};"},">":h,"<":function(e,n){var r={partials:{},code:"",subs:{},inPartial:!0};t.walk(e.nodes,r);var i=n.partials[h(e,n)];i.subs=r.subs,i.partials=r.partials},$:function(e,n){var r={subs:{},code:"",partials:n.partials,prefix:e.n};t.walk(e.nodes,r),n.subs[e.n]=r.code,n.inPartial||(n.code+='t.sub("'+c(e.n)+'",c,p,i);')},"\n":function(t,e){e.code+=p('"\\n"'+(t.last?"":" + i"))},_v:function(t,e){e.code+="t.b(t.v(t."+l(t.n)+'("'+c(t.n)+'",c,p,0)));'},_t:function(t,e){e.code+=p('"'+c(t.text)+'"')},"{":f,"&":f},t.walk=function(e,n){for(var r,i=0,s=e.length;i<s;i++)r=t.codegen[e[i].tag],r&&r(e[i],n);return n},t.parse=function(t,e,n){return n=n||{},i(t,"",[],n.sectionTags||[])},t.cache={},t.cacheKey=function(t,e){return[t,!!e.asString,!!e.disableLambda,e.delimiters,!!e.modelGet].join("||")},t.compile=function(e,n){n=n||{};var r=t.cacheKey(e,n),i=this.cache[r];if(i){var s=i.partials;for(var a in s)delete s[a].instance;return i}return i=this.generate(this.parse(this.scan(e,n.delimiters),e,n),e,n),this.cache[r]=i}}(e)},function(t,e,n){!function(t){function e(t,e,n){var r;return e&&"object"==typeof e&&(void 0!==e[t]?r=e[t]:n&&e.get&&"function"==typeof e.get&&(r=e.get(t))),r}function n(t,e,n,r,i,s){function a(){}function o(){}a.prototype=t,o.prototype=t.subs;var u,c=new a;c.subs=new o,c.subsText={},c.buf="",r=r||{},c.stackSubs=r,c.subsText=s;for(u in e)r[u]||(r[u]=e[u]);for(u in r)c.subs[u]=r[u];i=i||{},c.stackPartials=i;for(u in n)i[u]||(i[u]=n[u]);for(u in i)c.partials[u]=i[u];return c}function r(t){return String(null===t||void 0===t?"":t)}function i(t){return t=r(t),l.test(t)?t.replace(s,"&amp;").replace(a,"&lt;").replace(o,"&gt;").replace(u,"&#39;").replace(c,"&quot;"):t}t.Template=function(t,e,n,r){t=t||{},this.r=t.code||this.r,this.c=n,this.options=r||{},this.text=e||"",this.partials=t.partials||{},this.subs=t.subs||{},this.buf=""},t.Template.prototype={r:function(t,e,n){return""},v:i,t:r,render:function(t,e,n){return this.ri([t],e||{},n)},ri:function(t,e,n){return this.r(t,e,n)},ep:function(t,e){var r=this.partials[t],i=e[r.name];if(r.instance&&r.base==i)return r.instance;if("string"==typeof i){if(!this.c)throw new Error("No compiler available.");i=this.c.compile(i,this.options)}if(!i)return null;if(this.partials[t].base=i,r.subs){e.stackText||(e.stackText={});for(key in r.subs)e.stackText[key]||(e.stackText[key]=void 0!==this.activeSub&&e.stackText[this.activeSub]?e.stackText[this.activeSub]:this.text);i=n(i,r.subs,r.partials,this.stackSubs,this.stackPartials,e.stackText)}return this.partials[t].instance=i,i},rp:function(t,e,n,r){var i=this.ep(t,n);return i?i.ri(e,n,r):""},rs:function(t,e,n){var r=t[t.length-1];if(!h(r))return void n(t,e,this);for(var i=0;i<r.length;i++)t.push(r[i]),n(t,e,this),t.pop()},s:function(t,e,n,r,i,s,a){var o;return(!h(t)||0!==t.length)&&("function"==typeof t&&(t=this.ms(t,e,n,r,i,s,a)),o=!!t,!r&&o&&e&&e.push("object"==typeof t?t:e[e.length-1]),o)},d:function(t,n,r,i){var s,a=t.split("."),o=this.f(a[0],n,r,i),u=this.options.modelGet,c=null;if("."===t&&h(n[n.length-2]))o=n[n.length-1];else for(var l=1;l<a.length;l++)s=e(a[l],o,u),void 0!==s?(c=o,o=s):o="";return!(i&&!o)&&(i||"function"!=typeof o||(n.push(c),o=this.mv(o,n,r),n.pop()),o)},f:function(t,n,r,i){for(var s=!1,a=null,o=!1,u=this.options.modelGet,c=n.length-1;c>=0;c--)if(a=n[c],s=e(t,a,u),void 0!==s){o=!0;break}return o?(i||"function"!=typeof s||(s=this.mv(s,n,r)),s):!i&&""},ls:function(t,e,n,i,s){var a=this.options.delimiters;return this.options.delimiters=s,this.b(this.ct(r(t.call(e,i)),e,n)),this.options.delimiters=a,!1},ct:function(t,e,n){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(t,this.options).render(e,n)},b:function(t){this.buf+=t},fl:function(){var t=this.buf;return this.buf="",t},ms:function(t,e,n,r,i,s,a){var o,u=e[e.length-1],c=t.call(u);return"function"==typeof c?!!r||(o=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(c,u,n,o.substring(i,s),a)):c},mv:function(t,e,n){var i=e[e.length-1],s=t.call(i);return"function"==typeof s?this.ct(r(s.call(i)),i,n):s},sub:function(t,e,n,r){var i=this.subs[t];i&&(this.activeSub=t,i(e,n,this,r),this.activeSub=!1)}};var s=/&/g,a=/</g,o=/>/g,u=/\'/g,c=/\"/g,l=/[&<>\"\']/,h=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}}(e)},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){var r=n(1);t.exports=function(){var t=new r.Template({code:function(t,e,n){var r=this;return r.b(n=n||""),r.b('<li title="'),r.b(r.v(r.f("title",t,e,0))),r.b('" class="ext-cards-card">'),r.b("\n"+n),r.b('\t<div class="ext-cards-card-thumb" '),r.s(r.f("hasThumbnail",t,e,1),t,e,0,102,156,"{{ }}")&&(r.rs(t,e,function(t,e,n){n.b("style=\"background-image: url( '"),n.b(n.v(n.f("thumbnailUrl",t,e,0))),n.b("' );\"")}),t.pop()),r.b("></div>"),r.b("\n"+n),r.b('\t<a href="'),r.b(r.v(r.f("url",t,e,0))),r.b('" aria-hidden="true" tabindex="-1"></a>'),r.b("\n"+n),r.b('\t<div class="ext-cards-card-detail">'),r.b("\n"+n),r.b('\t\t<h3><a href="'),r.b(r.v(r.f("url",t,e,0))),r.b('">'),r.b(r.v(r.f("title",t,e,0))),r.b("</a></h3>"),r.b("\n"+n),r.b("\t\t"),r.s(r.f("extract",t,e,1),t,e,0,342,393,"{{ }}")&&(r.rs(t,e,function(t,e,n){n.b('<p class="ext-cards-card-extract">'),n.b(n.v(n.f("extract",t,e,0))),n.b("</p>")}),t.pop()),r.b("\n"+n),r.b("\t</div>"),r.b("\n"+n),r.b("</li>"),r.b("\n"),r.fl()},partials:{},subs:{}},'<li title="{{ title }}" class="ext-cards-card">\n\t<div class="ext-cards-card-thumb" {{# hasThumbnail }}style="background-image: url( \'{{ thumbnailUrl }}\' );"{{/ hasThumbnail }}></div>\n\t<a href="{{ url }}" aria-hidden="true" tabindex="-1"></a>\n\t<div class="ext-cards-card-detail">\n\t\t<h3><a href="{{ url }}">{{ title }}</a></h3>\n\t\t{{# extract }}<p class="ext-cards-card-extract">{{ extract }}</p>{{/ extract }}\n\t</div>\n</li>\n',r);return t}()},function(t,e,n){var r=n(1);t.exports=function(){var t=new r.Template({code:function(t,e,n){var r=this;return r.b(n=n||""),r.b('<ul class="ext-cards-card-list">'),r.b("\n"+n),r.b("</ul>"),r.b("\n"),r.fl()},partials:{},subs:{}},'<ul class="ext-cards-card-list">\n</ul>\n',r);return t}()},function(t,e,n){function r(t){this.api=t.api}function i(t){return"http://"===t.source.substr(0,7)||"https://"===t.source.substr(0,8)}var s=80,a=n(3),o=n(4),u=n(2);r.prototype.getCards=function(t,e){var n,r=[],c=$.Deferred();return t.length?(this.api.get({action:"query",prop:"extracts|pageimages",explaintext:!0,exlimit:t.length,exintro:!0,exsentences:1,pithumbsize:e||s,titles:t.join("|"),"continue":"",formatversion:2}).done(function(t){t.query&&t.query.pages&&(r=$.map(t.query.pages,function(t){return n={title:t.title,url:mw.util.getUrl(t.title),hasThumbnail:!1},t.thumbnail&&i(t.thumbnail)&&(n.hasThumbnail=!0,n.thumbnailUrl=t.thumbnail.source),t.extract&&(n.extract=t.extract),new o(new a(n))})),c.resolve(new u(r))}).fail(function(){c.resolve(new u(r))}),c):(c.resolve(new u(r)),c)},t.exports=r},function(t,e){(function(t){!function(t){t.CSS||(t.CSS={});var e=t.CSS,n=function(t){this.message=t};n.prototype=new Error,n.prototype.name="InvalidCharacterError",e.escape||(e.escape=function(t){for(var e,r=String(t),i=r.length,s=-1,a="",o=r.charCodeAt(0);++s<i;){if(e=r.charCodeAt(s),0==e)throw new n("Invalid character: the input contains U+0000.");a+=e>=1&&e<=31||127==e||0==s&&e>=48&&e<=57||1==s&&e>=48&&e<=57&&45==o?"\\"+e.toString(16)+" ":0==s&&1==i&&45==e||!(e>=128||45==e||95==e||e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122)?"\\"+r.charAt(s):r.charAt(s)}return a})}("undefined"!=typeof t?t:this)}).call(e,function(){return this}())},function(t,e,n){n(6),window.mw.cards=t.exports={CardModel:n(3),CardView:n(4),CardListView:n(2),CardsGateway:n(12)}}]);
//# sourceMappingURL=index.js.map